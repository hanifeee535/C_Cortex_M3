#include <stdint.h>
#include "../Drivers/stm32f103Driver.h"
#include "config.h"
#include "../Drivers/lcd_image.h"


//uint16_t period = 500;  
//uint8_t duty_percent = 10;  






unsigned char oled_buffer [8][128]; 
const unsigned short logo_rows = 9;
const unsigned short logo_cols = 128;
const unsigned char logo[] = {
0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,
0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x7f,0x7f,0x3f,0x3f,0x1f,0x9f,0x9f,0x8f,0xcf,0xcf,0xc7,0xe7,0xe7,0xe7,0xe7,0xf3,0xf3,0xf3,0x73,0x73,0x33,0xf3,0xf3,0xf1,0xf9,0xf9,0xf9,0xff,0xfb,0xf9,0xf9,0xf3,0xf3,0xf3,0xf3,0x73,0x73,0xf3,0xf3,0xf3,0xe7,0xe7,0xe7,0xe7,0xc7,0xcf,0xcf,0x8f,0x9f,0x9f,0x1f,0x3f,0x3f,0x7f,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x3f,0x1f,0xf,0x87,0xc3,0xe3,0xb1,0x18,0x58,0x5c,0x1e,0xbe,0xff,0xb3,0x63,0xeb,0xcb,0xb3,0xbf,0x7c,0x7f,0xff,0xff,0xff,0xc3,0x81,0x0,0x0,0x0,0x0,0xf,0x1f,0x1f,0x1f,0x3f,0x3f,0x3f,0x3f,0x3f,0x3f,0x1f,0x1f,0xf,0xf,0x0,0x80,0x80,0xc1,0xff,0xff,0xff,0xff,0x7f,0x7c,0xbf,0xb3,0xcb,0xeb,0x6b,0x73,0xff,0xfe,0x9e,0x1c,0xd8,0x58,0xb1,0xe1,0xc3,0x87,0xf,0x1f,0x3f,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf1,0xf0,0xf0,0xf8,0xde,0xdf,0xdf,0xd3,0xf5,0xf5,0xf1,0xf3,0xff,0xee,0xcc,0xdd,0xbb,0xba,0xb6,0xa5,0xad,0xdb,0xfb,0xd6,0xf6,0xfd,0xfd,0xfb,0xf3,0xf7,0xfe,0xfe,0xf2,0x4,0x4,0x4,0xe4,0xf4,0x14,0x14,0xf4,0xe4,0x6,0xf6,0xfe,0xff,0xff,0xe7,0xf7,0xfb,0xff,0xf5,0xf6,0xf6,0xf7,0xfb,0xe9,0xed,0xf6,0xfa,0xfb,0xfd,0xfd,0xfe,0xfe,0xfb,0xf1,0xfd,0xfd,0xf3,0xff,0xff,0xff,0xfc,0xf0,0xf0,0xf1,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf9,0xe1,0xc1,0x83,0xf,0x1f,0x3f,0x73,0xb5,0x9d,0x51,0x5b,0x9f,0xef,0xef,0xb7,0xd7,0xfb,0x6f,0xf5,0xb6,0xdb,0xdb,0xed,0xed,0x37,0xd7,0xdb,0xeb,0xed,0xf7,0xff,0xff,0x0,0x0,0x0,0xff,0xff,0x0,0x0,0xff,0xff,0x0,0xff,0xff,0xff,0xff,0xf5,0xef,0xeb,0xdf,0xb7,0x3f,0xed,0xff,0xdb,0xf6,0xb4,0x6d,0xeb,0xdb,0xf7,0xff,0xef,0x9f,0xdb,0xf3,0x9d,0xbd,0xf3,0x7f,0x1f,0xf,0x3,0x81,0xe1,0xf9,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfe,0xfc,0xf8,0xf8,0xf1,0xe3,0xe3,0xc7,0xc7,0xcf,0x89,0x98,0x9e,0x1a,0x38,0x3f,0x3f,0x7f,0x7f,0x7d,0x6c,0xe7,0xef,0xff,0xff,0xff,0xff,0xff,0x0,0x0,0x80,0xff,0xff,0x0,0x0,0xff,0xff,0x0,0xff,0xff,0xff,0xff,0xff,0xff,0xef,0xef,0xed,0x7c,0x7f,0x7f,0x7f,0x3f,0x39,0x3a,0x1e,0x9a,0x8d,0x8f,0xcf,0xc7,0xe3,0xe3,0xf1,0xf0,0xf8,0xfc,0xfe,0xfe,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf,0xf,0xf,0xff,0xff,0x7f,0xf,0xf,0x1f,0xff,0xff,0xf,0xf,0xf,0x1f,0x3f,0x7f,0xff,0xff,0xff,0x7f,0x3f,0x1f,0xe,0xe,0xe,0xfe,0xfe,0xfc,0xc,0xc,0x1c,0xfc,0xfc,0xd,0xd,0x9,0x19,0x19,0x39,0x7f,0x7f,0xf9,0xf9,0x9,0x9,0xd,0xfd,0xfc,0x3c,0x1c,0x1c,0x9c,0xcc,0xce,0xce,0xce,0xce,0xcf,0x9f,0x1f,0x3f,0x7f,0xef,0x8f,0xf,0x1f,0x3f,0x7f,0xff,0xff,0xff,0x7f,0x3f,0x1f,0x8f,0xcf,0xef,0xff,0x7f,0x3f,0x1f,0x8f,0x8f,0x1f,0x3f,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfd,0xf9,0xf9,0xf3,0xf3,0xf3,0xf3,0xf8,0xf8,0xfc,0xff,0x9f,0xff,0x90,0xf0,0x9e,0x9f,0xff,0xf0,0xf0,0x98,0xff,0xfe,0xfe,0x9c,0xf8,0xf8,0xfc,0xfe,0x9f,0xb8,0xf0,0xf0,0x9f,0xff,0x9f,0xf0,0xf0,0xf8,0xff,0xbf,0xf8,0x90,0x90,0xff,0xff,0xff,0xfe,0x9c,0xfc,0xf8,0x98,0xf0,0xf8,0xff,0xff,0x9e,0x9c,0xf8,0xf9,0x9b,0xf3,0x93,0xf3,0xf3,0xb9,0xf9,0xf8,0x9c,0xfe,0xbf,0xff,0xff,0x9e,0xdc,0xf8,0x91,0xf1,0xb0,0x98,0xfc,0x9e,0xff,0x97,0xd1,0xb0,0x98,0xfc,0xfc,0xfd,0xfd,0xfc,0xfc,0xf8,0xf0,0xf1,0xf3,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff
};

// void SysTick_Handler(void){	
	
// 	toggle_gpio (portC, 0); 
 	
	
//  }

// void TIM1_UP_IRQHandler(void)
// {
//     if (TIM1->SR & (1 << 0)) {
//         TIM1->SR &= ~(1 << 0); // Clear the update interrupt flag

//         toggle_gpio (portC, 0);
//     }
// }

//  void USART1_IRQHandler  (void){
// 	char message = 'c';
// 	message = USART_receive (1);
// 	USART_transmit (1, message);
// }



int main (){	


	/*By default, internal rc oscillator (HSI) is activeted and the frequency is 8MHz.
	If you need to use HSE and want to configure the clock for more higher frequency, for example
	16/48/64/72 (max) MHZ, you can use  this function: */

	ConfigureSystemClock_HSE( hse_freq, system_freq);



	/*If you want to use HSI and need higher frequency for example: 16, 48, 64(maz) etc, use this function: */

	//ConfigureSystemClock_HSI(system_freq); 


	//systic_init();

	//Systick_interrupt(system_freq, 10);

	//timer_irq_milisecond_start (1, 1000,system_freq);
	
	Config_GPIO(portC, 0, output_50Mhz, gp_output);
	//Config_GPIO(portA, 4, output_50Mhz, gp_output);
	//Config_GPIO(portB, 10, output_50Mhz, gp_output);
	//Config_GPIO(portC ,  13, input ,pp_in);

	//Write_GPIO (portC , 0, HIGH);
	//Write_GPIO (portA , 4, HIGH);
	//Write_GPIO (portB , 10, HIGH);
	//timer_PWM_Microsecond(portA, 0, period, duty_percent,system_freq); 
	//init_USART ( 1, 9600 );
	//init_usart_receive_interrupt(1, 9600, 0);

	// LCD1602_init ();
	// delay_miliSecond(3, 50,system_freq);
	// LCD1602_print (1, 2, "hello world");

	// Define the struct instance
	
 // Initialize the struct directly
    lcd_image_typedef logo_pic = {
        .height = logo_rows,
        .width = logo_cols,
        .x_position = 0,
        .y_position = 0,
        .image = {logo,0,0,0,0} // Initialize image[0], others are 0
    };



	oled_configure_64 (1);
	oled_blank(1);

	clear_oled_buffer ( oled_buffer );
	update_oled_buffer(&logo_pic, 0, oled_buffer);
	print_buffer(1, oled_buffer);
	delay_miliSecond(3, 3000,system_freq);	
	oled_blank(1);
	oled_send_message_8X8_font(1, "WELCOME", 2, 3, 16, NON_INVERTED);
	
	delay_microSecond(2, 10000,system_freq);	

	
	
	oled_blank(1);
	
	oled_send_message_8X8_font(1, "Select an Option", 1, 0, 0, NON_INVERTED);
	oled_send_message_8X8_font(1, "1.Set Time",     1, 3, 0, INVERTED);
	oled_send_message_8X8_font(1, "2.Set Datte",    1, 4, 0, NON_INVERTED);
	oled_send_message_8X8_font(1, "3.Set Alarm",    1, 5, 0, NON_INVERTED);
	oled_send_message_8X8_font(1, "Select", 		 1, 7, 0, NON_INVERTED);
	oled_send_message_8X8_font(1, "Back", 			 1, 7, 96, NON_INVERTED);
	
	while (1){
			toggle_gpio (portC, 0); 
			delay_microSecond(2, 10000,system_freq);
			delay_microSecond(2, 10000,system_freq);
			delay_microSecond(2, 10000,system_freq);
			//USART_send_string(1, "hello world");
			//USART_transmit(1, '\n');
            
		
		}
	


}